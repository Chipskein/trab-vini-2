<div class="break-inside-avoid bg-white rounded-lg shadow mb-4 overflow-hidden">
    <% if (post.imageUri) { %>
        <a href="/web/posts/<%= post?.id %>">
            <img src="<%= post.imageUri %>" alt="Pin Image" class="w-full rounded-t-lg" />
    <% } %>
            <div class="p-4">
                <h2 class="font-semibold text-lg text-gray-900 mb-2">
                    <%= post.title %>
                </h2>
                <p class="text-gray-700 mb-3">
                    <%= post.description %>
                </p>

                <% if (post.comments && post.comments.length>0) { %>
                    <div class="border-t border-gray-200 pt-2 mt-2">
                        <h3 class="text-sm font-semibold text-gray-600 mb-1">Comments</h3>
                        <ul class="space-y-2">
                            <% post.comments.forEach(function(comment) { %>
                                <li class="text-sm text-gray-700 bg-gray-50 p-2 rounded-md">
                                    <span class="font-semibold">
                                        <%= comment.usuario?.name || 'Anonymous' %>:
                                    </span>
                                    <%= comment.description || '(no text)' %>
                                </li>
                                <% }); %>
                        </ul>
                        <p class="text-xs text-gray-500 mt-1 italic">Only showing first 3 comments...</p>
                    </div>

                    <% } else { %>
                        <p class="text-sm text-gray-400 italic">No comments yet.</p>
                        <% } %>

            </div>
            </a>
            <form action="/api/posts" method="POST" class="mt-3 border-t border-gray-200 pt-3">
                <div class="flex items-center gap-2">
                    <input type="number" name="parentId" style="display: none;" value=<%=post.id %> />
                    <input type="text" name="description" placeholder="Add a comment..." required
                        class="flex-1 border border-gray-300 rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-red-400" />
                    <button type="submit" class="px-3 py-1 bg-red-500 text-white text-sm rounded-lg hover:bg-red-600 transition">
                        Post
                    </button>
                </div>
            </form>
</div>